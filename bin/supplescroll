#!/usr/bin/env python
 
import os
import glob
from docopt import docopt
import supplescroll

theme = 'light'

# get available themes from file
supple_dir = os.path.dirname(supplescroll.__file__)
fnames = glob.glob(os.path.join(supple_dir, 'src', '*.css'))
fnames = map(os.path.basename, fnames)
themes = map(lambda f: os.path.splitext(f)[0], fnames)
themes.remove(theme)
themes.remove('supplescroll')
themes.insert(0, theme + '(default)')
themes = ', '.join(themes)


__doc__ = """
Makes HTML with auto-generated TOC, figure list from markdown

Usage: supplescroll [-o <html>] <markdown> [<theme>]

Options:
 <theme>     %s
 -o <html>   Output HTML filename
""" % themes


if __name__ == "__main__":
  arg = docopt(__doc__)
  in_markdown = arg['<markdown>']
  if not os.path.isfile(in_markdown):
    raise Exception("%s not found" % in_markdown)

  if arg['<theme>']:  
    theme = arg['<theme>'] 

  if arg['-o']: 
    html = arg['-o']
  else: 
    html = os.path.splitext(arg['<markdown>'])[0] + '.html'

  supplescroll.make_html(theme, in_markdown, html)
  print "Made", html


